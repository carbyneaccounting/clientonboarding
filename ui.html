<!-- ui.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Client Onboarding</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://fonts.cdnfonts.com/css/baron" rel="stylesheet">

  <style>
    *{ margin:0; padding:0; box-sizing:border-box; }

    :root{
      --carbyne-blue:#00305B;
      --carbyne-blue-2:#0A3D6F;
      --radius:18px;
      --shadow:0 28px 56px rgba(0,0,0,0.30);
    }

    body{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:40px 20px;
      background:linear-gradient(135deg, var(--carbyne-blue) 0%, var(--carbyne-blue-2) 50%, var(--carbyne-blue) 100%);
      position:relative;
      font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    .top-left-info{
      position:absolute;
      top:20px;
      left:20px;
      color:#ffffff;
    }

    .company-name{
      font-size:16px;
      font-weight:700;
      margin-bottom:2px;
    }

    .address{
      font-size:13px;
      font-weight:600;
      letter-spacing:.2px;
      line-height:1.35;
      opacity:.98;
    }

    .container{
      width:min(1200px, 95vw);
      display:flex;
      flex-direction:column;
    }

    h1{
      font-family:'Baron', sans-serif;
      font-size:22px;
      color:#ffffff;
      font-weight:normal;
      margin-bottom:14px;
    }

    .card{
      width:100%;
      height:clamp(520px, 72vh, 860px);
      background:#ffffff;
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      display:flex;
      flex-direction:column;
      overflow:hidden;
      position:relative;
    }

    .top-section{
      padding:18px 30px;
      border-bottom:1px solid #e6e6e6;
      background:#ffffff;
      z-index:2;
    }

    .progress-bar-container{
      width:100%;
      height:8px;
      background:#dedede;
      border-radius:999px;
      overflow:hidden;
    }

    .progress-bar-fill{
      height:100%;
      width:20%;
      background:linear-gradient(90deg, var(--carbyne-blue) 0%, var(--carbyne-blue-2) 100%);
      border-radius:999px;
      transition:width .25s ease;
    }

    /* PAGE 1: winter scenic background + dark black tint */
    .middle-section{
      flex:1;
      padding:26px 30px;
      overflow:auto;
      background:
        linear-gradient(
          180deg,
          rgba(0,0,0,0.52) 0%,
          rgba(0,0,0,0.42) 45%,
          rgba(0,0,0,0.52) 100%
        ),
        url("https://images.unsplash.com/photo-1519681393784-d120267933ba");
      background-size:cover;
      background-position:center;
      background-repeat:no-repeat;
      position:relative;
    }

    #accessMount{
      width:100%;
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .load-error{
      width:min(760px, 92%);
      background:rgba(255,255,255,0.92);
      border:1px solid rgba(0,0,0,0.08);
      border-radius:14px;
      padding:18px 20px;
      color:#111827;
      font-size:14px;
      line-height:1.4;
      box-shadow:0 16px 32px rgba(0,0,0,0.18);
    }

    .bottom-section{
      padding:18px 30px;
      border-top:1px solid #e6e6e6;
      background:#ffffff;
      z-index:2;
    }

    .navigation{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
    }

    .nav-button{
      padding:10px 24px;
      border:none;
      border-radius:8px;
      font-size:14px;
      font-weight:700;
      cursor:pointer;
      transition:opacity .15s ease, transform .15s ease;
    }

    .nav-button.previous{
      background:#f0f0f0;
      color:#333;
    }

    .nav-button.previous:hover{
      opacity:.95;
      transform:translateY(-1px);
    }

    .nav-button.next{
      background:linear-gradient(90deg, var(--carbyne-blue) 0%, var(--carbyne-blue-2) 100%);
      color:#ffffff;
    }

    .nav-button.next:hover{
      opacity:.95;
      transform:translateY(-1px);
    }

    .nav-button:disabled{
      opacity:.45;
      cursor:not-allowed;
      transform:none;
    }

    .page-indicator{
      font-size:14px;
      color:#666;
      font-weight:600;
    }

    .footer{
      position:absolute;
      bottom:20px;
      left:20px;
      color:#ffffff;
      font-size:13px;
      font-weight:600;
      opacity:.95;
    }
  </style>
</head>

<body>
  <div class="top-left-info">
    <div class="company-name">Carbyne Accounting</div>
    <div class="address">
      734 West Main Street, Suite 106<br>
      Louisville, Kentucky 40202<br>
      (502) 632-9444 | Client@CarbyneAccounting.com
    </div>
  </div>

  <div class="container">
    <h1>Client Onboarding</h1>

    <div class="card">
      <div class="top-section">
        <div class="progress-bar-container">
          <div class="progress-bar-fill"></div>
        </div>
      </div>

      <div class="middle-section">
        <div id="accessMount"></div>
      </div>

      <div class="bottom-section">
        <div class="navigation">
          <button class="nav-button previous" disabled>Previous</button>
          <span class="page-indicator">Step 1 of 5</span>
          <button class="nav-button next">Next</button>
        </div>
      </div>
    </div>
  </div>

  <div class="footer">Carbyne Accountingâ„¢ - Confidential &amp; Proprietary System</div>

  <script>
    const ACCESS_URL = "https://raw.githubusercontent.com/carbyneaccounting/clientonboarding/refs/heads/main/access.html";

    function resolveUrl(base, relative){
      try{ return new URL(relative, base).toString(); }
      catch(_){ return relative; }
    }

    function clearInjectedAssets(){
      document.querySelectorAll('[data-access-injected="1"]').forEach(n => n.remove());
    }

    async function loadAccessModule(){
      const mount = document.getElementById("accessMount");
      mount.innerHTML = "";
      clearInjectedAssets();

      try{
        const res = await fetch(ACCESS_URL, { cache: "no-store" });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);

        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, "text/html");

        const styleTags = Array.from(doc.querySelectorAll("style"));
        const linkTags  = Array.from(doc.querySelectorAll('link[rel="stylesheet"]'));
        const scriptTags = Array.from(doc.querySelectorAll("script"));

        const fragmentRoot = doc.querySelector("#accessModule") || doc.body || doc.documentElement;

        linkTags.forEach(l => {
          const href = l.getAttribute("href");
          if (!href) return;
          const abs = resolveUrl(ACCESS_URL, href);

          const already = Array.from(document.querySelectorAll('link[rel="stylesheet"]'))
            .some(x => x.getAttribute("href") === abs);

          if (!already){
            const nl = document.createElement("link");
            nl.rel = "stylesheet";
            nl.href = abs;
            nl.setAttribute("data-access-injected","1");
            document.head.appendChild(nl);
          }
        });

        styleTags.forEach(st => {
          const ns = document.createElement("style");
          ns.textContent = st.textContent || "";
          ns.setAttribute("data-access-injected","1");
          document.head.appendChild(ns);
        });

        if (fragmentRoot && fragmentRoot.id === "accessModule"){
          mount.appendChild(fragmentRoot);
        } else {
          const wrapper = document.createElement("div");
          wrapper.innerHTML = html;
          const extracted = wrapper.querySelector("#accessModule") || wrapper.querySelector("body") || wrapper;

          if (extracted){
            const nodes = Array.from(extracted.childNodes);
            nodes.forEach(n => mount.appendChild(n));
          }
        }

        scriptTags.forEach(sc => {
          const src = sc.getAttribute("src");
          const ns = document.createElement("script");
          ns.setAttribute("data-access-injected","1");

          if (src){
            ns.src = resolveUrl(ACCESS_URL, src);
            ns.defer = true;
          } else {
            ns.textContent = sc.textContent || "";
          }
          document.body.appendChild(ns);
        });

      } catch (e){
        mount.innerHTML = `
          <div class="load-error">
            <strong>Failed to load access module.</strong><br>
            ${String(e.message || e)}
          </div>
        `;
      }
    }

    loadAccessModule();
  </script>
</body>
</html>
